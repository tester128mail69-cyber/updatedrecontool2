<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}GODRECON Dashboard{% endblock %}</title>
    <link rel="stylesheet" href="/dashboard/static/style.css">
    {% block head %}{% endblock %}
</head>
<body>
<div class="app-shell">
  <!-- ===== TOP HEADER ===== -->
  <header class="app-header">
    <button class="hamburger-btn" id="hamburgerBtn" aria-label="Toggle menu">â˜°</button>
    <a href="/dashboard/" class="header-brand"><span>ğŸ”±</span> GODRECON</a>

    <!-- Global Search -->
    <div class="header-search">
      <span class="search-icon">ğŸ”</span>
      <input type="text" id="globalSearchInput" placeholder="Search targets, findings, scansâ€¦ (Ctrl+K)" readonly onclick="openSearchModal()">
      <span class="search-kbd">Ctrl+K</span>
    </div>

    <div class="header-actions">
      <!-- Notifications -->
      <div style="position:relative;">
        <button class="header-icon-btn" id="notifBtn" aria-label="Notifications">
          ğŸ””
          <span class="notif-badge" id="notifCount">0</span>
        </button>
        <div class="notif-panel" id="notifPanel">
          <div class="notif-panel-header">
            <span>Notifications</span>
            <button class="btn btn-xs" onclick="markAllRead()">Mark all read</button>
          </div>
          <div class="notif-list" id="notifList">
            <div class="notif-item"><div class="notif-item-title text-muted">No notifications</div></div>
          </div>
        </div>
      </div>

      <!-- Dark/Light Toggle -->
      <button class="header-icon-btn" id="themeToggle" aria-label="Toggle dark/light mode" title="Toggle dark/light mode">ğŸŒ™</button>

      <!-- User menu -->
      <button class="user-menu-btn">
        <span>ğŸ‘¤</span> GODRECON
      </button>

      <!-- API Docs -->
      <a href="/docs" class="btn btn-sm" target="_blank">API Docs</a>
    </div>
  </header>

  <div class="app-body">
    <!-- ===== SIDEBAR ===== -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-nav">

        <!-- Main -->
        <div class="nav-section">
          <a href="/dashboard/" class="nav-item {% if request.url.path == '/dashboard/' or request.url.path == '/dashboard' %}active{% endif %}">
            <span class="nav-icon">ğŸ </span> Dashboard
          </a>
          <a href="/dashboard/targets" class="nav-item {% if '/dashboard/targets' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ¯</span> Targets
          </a>
          <a href="/dashboard/subdomains" class="nav-item {% if '/dashboard/subdomains' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ”</span> Subdomains
          </a>
          <a href="/dashboard/vulnerabilities" class="nav-item {% if '/dashboard/vulnerabilities' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ›</span> Vulnerabilities
          </a>
          <a href="/dashboard/chains" class="nav-item {% if '/dashboard/chains' in request.url.path %}active{% endif %}">
            <span class="nav-icon">â›“ï¸</span> Vuln Chains
          </a>
          <a href="/dashboard/secrets" class="nav-item {% if '/dashboard/secrets' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ”‘</span> Secrets
          </a>
          <a href="/dashboard/kanban" class="nav-item {% if '/dashboard/kanban' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ“‹</span> Kanban Board
          </a>
          <a href="/dashboard/reports" class="nav-item {% if '/dashboard/reports' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ“Š</span> Reports
          </a>
        </div>

        <div class="nav-divider"></div>

        <!-- Scanners collapsible -->
        <div class="nav-section">
          <div class="nav-item nav-group-trigger" onclick="toggleNavGroup('scanners-group')" style="cursor:pointer;">
            <span class="nav-icon">ğŸ”¬</span> Scanners
            <span class="nav-chevron" id="scanners-group-chevron">â–¶</span>
          </div>
          <div class="nav-group-children" id="scanners-group">
            <a href="/dashboard/scanners/nuclei" class="nav-item {% if '/scanners/nuclei' in request.url.path %}active{% endif %}">Nuclei</a>
            <a href="/dashboard/scanners/cloud" class="nav-item {% if '/scanners/cloud' in request.url.path %}active{% endif %}">Cloud Misconfig</a>
            <a href="/dashboard/scanners/auth" class="nav-item {% if '/scanners/auth' in request.url.path %}active{% endif %}">Auth Scan</a>
            <a href="/dashboard/scanners/waf" class="nav-item {% if '/scanners/waf' in request.url.path %}active{% endif %}">WAF Detection</a>
            <a href="/dashboard/scanners/fuzzing" class="nav-item {% if '/scanners/fuzzing' in request.url.path %}active{% endif %}">Fuzzing</a>
            <a href="/dashboard/scanners/cve" class="nav-item {% if '/scanners/cve' in request.url.path %}active{% endif %}">CVE/Exploits</a>
            <a href="/dashboard/scanners/dns" class="nav-item {% if '/scanners/dns' in request.url.path %}active{% endif %}">DNS Analysis</a>
            <a href="/dashboard/scanners/ssl" class="nav-item {% if '/scanners/ssl' in request.url.path %}active{% endif %}">SSL/TLS</a>
            <a href="/dashboard/scanners/email" class="nav-item {% if '/scanners/email' in request.url.path %}active{% endif %}">Email Security</a>
            <a href="/dashboard/scanners/supply-chain" class="nav-item {% if '/scanners/supply-chain' in request.url.path %}active{% endif %}">Supply Chain</a>
            <a href="/dashboard/scanners/mobile-api" class="nav-item {% if '/scanners/mobile-api' in request.url.path %}active{% endif %}">Mobile API</a>
            <a href="/dashboard/scanners/passive-recon" class="nav-item {% if '/scanners/passive-recon' in request.url.path %}active{% endif %}">Passive Recon</a>
            <a href="/dashboard/scanners/wayback" class="nav-item {% if '/scanners/wayback' in request.url.path %}active{% endif %}">Wayback Machine</a>
            <a href="/dashboard/scanners/business-logic" class="nav-item {% if '/scanners/business-logic' in request.url.path %}active{% endif %}">Business Logic</a>
            <a href="/dashboard/scanners/multi-region" class="nav-item {% if '/scanners/multi-region' in request.url.path %}active{% endif %}">Multi-Region</a>
            <a href="/dashboard/scanners/cache-poisoning" class="nav-item {% if '/scanners/cache-poisoning' in request.url.path %}active{% endif %}">Cache Poisoning</a>
            <a href="/dashboard/scanners/browser-extensions" class="nav-item {% if '/scanners/browser-extensions' in request.url.path %}active{% endif %}">Browser Extensions</a>
            <a href="/dashboard/scanners/scan-diff" class="nav-item {% if '/scanners/scan-diff' in request.url.path %}active{% endif %}">Scan Diff</a>
            <a href="/dashboard/scanners/smart-params" class="nav-item {% if '/scanners/smart-params' in request.url.path %}active{% endif %}">Smart Params</a>
            <a href="/dashboard/scanners/oob" class="nav-item {% if '/scanners/oob' in request.url.path %}active{% endif %}">OOB Callbacks</a>
            <a href="/dashboard/scanners/github-dorking" class="nav-item {% if '/scanners/github-dorking' in request.url.path %}active{% endif %}">GitHub Dorking</a>
          </div>
        </div>

        <div class="nav-divider"></div>

        <!-- Analytics collapsible -->
        <div class="nav-section">
          <div class="nav-item nav-group-trigger" onclick="toggleNavGroup('analytics-group')" style="cursor:pointer;">
            <span class="nav-icon">ğŸ“ˆ</span> Analytics
            <span class="nav-chevron" id="analytics-group-chevron">â–¶</span>
          </div>
          <div class="nav-group-children" id="analytics-group">
            <a href="/dashboard/analytics" class="nav-item {% if request.url.path == '/dashboard/analytics' %}active{% endif %}">Overview</a>
            <a href="/dashboard/analytics/trends" class="nav-item {% if '/analytics/trends' in request.url.path %}active{% endif %}">Trend Charts</a>
            <a href="/dashboard/analytics/severity" class="nav-item {% if '/analytics/severity' in request.url.path %}active{% endif %}">Severity Charts</a>
            <a href="/dashboard/analytics/compare" class="nav-item {% if '/analytics/compare' in request.url.path %}active{% endif %}">Target Comparison</a>
            <a href="/dashboard/analytics/ai-insights" class="nav-item {% if '/analytics/ai-insights' in request.url.path %}active{% endif %}">AI Insights</a>
            <a href="/dashboard/analytics/earnings" class="nav-item {% if '/analytics/earnings' in request.url.path %}active{% endif %}">Earnings Tracker</a>
          </div>
        </div>

        <div class="nav-divider"></div>

        <!-- Other pages -->
        <div class="nav-section">
          <a href="/dashboard/ai-validation" class="nav-item {% if '/dashboard/ai-validation' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ¤–</span> AI Validation
          </a>
          <a href="/dashboard/bounty-matcher" class="nav-item {% if '/dashboard/bounty-matcher' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ¯</span> Bounty Matcher
          </a>
          <a href="/dashboard/leaderboard" class="nav-item {% if '/dashboard/leaderboard' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ†</span> Leaderboard
          </a>
          <a href="/dashboard/activity-log" class="nav-item {% if '/dashboard/activity-log' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ“‹</span> Activity Log
          </a>
          <a href="/dashboard/alerts" class="nav-item {% if '/dashboard/alerts' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ””</span> Alerts
          </a>
          <a href="/dashboard/settings" class="nav-item {% if '/dashboard/settings' in request.url.path %}active{% endif %}">
            <span class="nav-icon">âš™ï¸</span> Settings
          </a>
        </div>

        <div class="nav-divider"></div>

        <!-- Legacy -->
        <div class="nav-section">
          <div class="nav-section-label">Legacy</div>
          <a href="/dashboard/scans" class="nav-item {% if '/dashboard/scans' in request.url.path and '/scanners' not in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ—‚</span> Scans
          </a>
          <a href="/dashboard/findings" class="nav-item {% if '/dashboard/findings' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ”</span> Findings
          </a>
          <a href="/dashboard/surface" class="nav-item {% if '/dashboard/surface' in request.url.path %}active{% endif %}">
            <span class="nav-icon">ğŸ—º</span> Attack Surface
          </a>
        </div>

      </div>
    </nav>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="main-content">
      <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) if get_flashed_messages is defined else [] %}
          {% for category, message in messages %}
            <div class="alert alert-{{ category }}">{{ message }}</div>
          {% endfor %}
        {% endwith %}
        {% block content %}{% endblock %}
      </div>
    </main>
  </div>
</div>

<!-- Toast container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Global Search Modal -->
<div class="search-modal-overlay" id="searchModalOverlay" onclick="closeSearchModal(event)">
  <div class="search-modal" onclick="event.stopPropagation()">
    <input type="text" class="search-modal-input" id="searchModalInput" placeholder="Search targets, findings, scans, pagesâ€¦" autocomplete="off">
    <div class="search-modal-results" id="searchModalResults"></div>
  </div>
</div>

<script src="/dashboard/static/dashboard.js"></script>
{% block scripts %}{% endblock %}
<script>
// Auto-open sidebar group if current page matches
(function() {
  const path = window.location.pathname;
  if (path.includes('/scanners/')) {
    const g = document.getElementById('scanners-group');
    if (g) { g.style.display = 'block'; document.getElementById('scanners-group-chevron').style.transform = 'rotate(90deg)'; }
  }
  if (path.includes('/analytics')) {
    const g = document.getElementById('analytics-group');
    if (g) { g.style.display = 'block'; document.getElementById('analytics-group-chevron').style.transform = 'rotate(90deg)'; }
  }
})();
</script>
</body>
</html>
